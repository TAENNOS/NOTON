generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  extensions = [pgvector(map: "vector")]
}

model Embedding {
  id          String                      @id @default(cuid())
  workspaceId String
  sourceType  String
  sourceId    String
  content     String
  embedding   Unsupported("vector(768)")?
  createdAt   DateTime                    @default(now())

  @@index([workspaceId, sourceType])
}

model Conversation {
  id          String    @id @default(cuid())
  workspaceId String
  userId      String
  title       String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  messages ConversationMessage[]
}

model ConversationMessage {
  id             String   @id @default(cuid())
  conversationId String
  role           String
  content        String
  createdAt      DateTime @default(now())

  conversation Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)
}
